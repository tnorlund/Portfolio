# Receipt Trainer

## Metrics in DynamoDB

- [x] Add F1 Score tracking to evaluate NER/token classification performance
- [x] Implement Token-level Precision and Recall metrics
- [x] Track Entity-level metrics:
  - [x] Entity-level F1
  - [x] Entity-level accuracy by class (business_name, total_amount, etc.)
- [x] Generate Confusion Matrix to understand entity misclassifications
- [ ] Implement IoU (Intersection over Union) for spatial accuracy of bounding boxes
- [x] Add receipt-specific metrics:
  - [x] Field extraction accuracy (total amount, date, store name)
  - [ ] Line-item detection accuracy

## Distributed Training Infrastructure

- [x] Integrate SQS job queue system with main training pipeline:

  - [x] Implement job classes (Job, JobStatus, JobPriority, JobQueue)
  - [x] Create worker module for processing jobs from SQS
  - [x] Complete direct connection between JobQueue and ReceiptTrainer
  - [x] Implement full job status updates via SQS

- [ ] Implement EFS capabilities for distributed training:

  - [x] Create EFSManager for EFS mounting functionality
  - [x] Implement methods to mount and check EFS filesystems
  - [ ] Enhance checkpoint sharing between training instances
  - [ ] Fully integrate EFS mounts with training workflow

- [ ] Instance coordination and management:

  - [x] Implement InstanceRegistry class for cluster awareness
  - [x] Create leader election functionality
  - [ ] Complete integration with Instance Registry for coordinated tasks
  - [ ] Enhance heartbeat monitoring for health checks

- [ ] Fault tolerance and recovery:

  - [x] Create SpotInstanceHandler for handling spot interruptions
  - [x] Implement job retry strategies
  - [ ] Complete job recovery logic after spot interruptions
  - [x] Add visibility timeout management for long-running jobs

- [x] Auto-scaling and resource optimization:
  - [x] Add logic to request/release instances based on queue depth
  - [x] Select appropriate instance type based on job requirements
  - [x] Implement cost optimization strategies with instance selection
